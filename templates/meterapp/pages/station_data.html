{% extends "../base_power_system.html" %}
{%  load static %}
{% block title %}SPS(Station Detail){% endblock %}  <!-- Smart Power System -->
{% block content %}
<script src="{% static 'js/iotPowerSystem/sps.js' %}"></script>

<!-- Page Loader -->
{% include 'partials/_messages.html' %}
{% include '../component/loader.html' %}
<!-- #END# Page Loader -->
 <!-- Top Bar -->
{% include '../component/nav.html' %}
 <!-- End Top Bar -->
 <!-- Sidebar -->
 {% include '../component/sidebar.html' %}
 <!-- End Sidebar -->
 <!-- pagecontent -->
 
<section class="content">
    <div class="container-fluid">
        <div id="autoauto"  data-url="{% url 'smartpower:auto' st %}">
            <div class="block-header">
                <div class="row">
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12"><h2>DASHBOARD</h2><h4></h4>ACTIVE POWER</div>
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12"><h2>DAY</h2><h4 id="day"></h4></div>
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12"><h2>TIME</h2><h4 id="hourly"></h4></div>
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12"><h2>STATION</h2><h4 id="station"></h4></div>
                </div>
            </div>

            <!-- Widgets power -->
            <div class="row clearfix">
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-red hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">playlist_add_check</i>-->
                            <h4>KW</h4>
                        </div>
                        <div class="content">
                            <div class="text">RED PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="125" data-speed="15" data-fresh-interval="20"></div>-->
                            <div class="number count-to" id="powerR"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-yellow hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">help</i>-->
                            <h4>KW</h4>
                        </div>
                        <div class="content">
                            <div class="text">YELLOW PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="257" data-speed="1000" data-fresh-interval="20"></div>-->
                            <div class="number count-to"  id="powerY"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-blue hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">forum</i>-->
                            <h4>KW</h4>
                        </div>
                        <div class="content">
                            <div class="text">BLUE PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="243" data-speed="1000" data-fresh-interval="20"></div>-->
                            <div class="number count-to" id="powerB"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-orange hover-expand-effect">
                        <div class="icon">
                            <div class="material-icons">device_thermostat</div>
                            <h4>&deg;C</h4>
                        </div>
                        <div class="content">
                            <div class="text">TEMPATURE</div>
                            <!--<div class="number count-to" data-from="0" data-to="1225" data-speed="1000" data-fresh-interval="20"></div>-->
                            <div class="number count-to" id="temp"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- #END# Widgets -->
            <!-- Widgets voltage-->
            <div class="row clearfix">
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-red hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">playlist_add_check</i>-->
                            <h4>KV</h4>
                        </div>
                        <div class="content">
                            <div class="text">RED PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="125" data-speed="15" data-fresh-interval="20"></div>-->
                            <div class="number count-to" id="voltR"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-yellow hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">help</i>-->
                            <h4>KV</h4>
                        </div>
                        <div class="content">
                            <div class="text">YELLOW PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="257" data-speed="1000" data-fresh-interval="20"></div>-->
                            <div class="number count-to"  id="voltY"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-blue hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">forum</i>-->
                            <h4>KV</h4>
                        </div>
                        <div class="content">
                            <div class="text">BLUE PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="243" data-speed="1000" data-fresh-interval="20"></div>-->
                            <div class="number count-to" id="voltB"></div>
                        </div>
                    </div>
                </div>
                <!--<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-orange hover-expand-effect">
                        <div class="icon">
                            <div class="material-icons">device_thermostat</div>
                            <h4>&deg;C</h4>
                        </div>
                        <div class="content">
                            <div class="text">TEMPATURE</div>
                            <div class="number count-to" id="temp"></div>
                        </div>
                    </div>
                </div> -->
            </div>
            <!-- #END# voltage Widgets -->
            <!-- Widgets amp -->
            <div class="row clearfix">
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-red hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">playlist_add_check</i>-->
                            <h4>KAmp</h4>
                        </div>
                        <div class="content">
                            <div class="text">RED PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="125" data-speed="15" data-fresh-interval="20"></div>-->
                            <div class="number count-to" id="ampR"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-yellow hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">help</i>-->
                            <h4>KAmp</h4>
                        </div>
                        <div class="content">
                            <div class="text">YELLOW PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="257" data-speed="1000" data-fresh-interval="20"></div>-->
                            <div class="number count-to"  id="ampY"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-blue hover-expand-effect">
                        <div class="icon">
                            <!--<i class="material-icons">forum</i>-->
                            <h4>KAmp</h4>
                        </div>
                        <div class="content">
                            <div class="text">BLUE PHASE</div>
                            <!--<div class="number count-to" data-from="0" data-to="243" data-speed="1000" data-fresh-interval="20"></div>-->
                            <div class="number count-to" id="ampB"></div>
                        </div>
                    </div>
                </div>
                <!--<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                    <div class="info-box bg-orange hover-expand-effect">
                        <div class="icon">
                            <div class="material-icons">device_thermostat</div>
                            <h4>&deg;C</h4>
                        </div>
                        <div class="content">
                            <div class="text">TEMPATURE</div>
                            <div class="number count-to" id="temp"></div>
                        </div>
                    </div>
                </div>-->
            </div>
        </div>    
        <!-- #END# amp Widgets -->
        <!-- CPU Usage -->

        <div class="row clearfix">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="card">
                    <div class="header">
                        <div class="row clearfix">
                            <div class="col-xs-12 col-sm-6">
                                <h2>CPU USAGE (%)</h2>
                            </div>
                            <div class="col-xs-12 col-sm-6 align-right">
                                <div class="switch panel-switch-btn">
                                    <span class="m-r-10 font-12">REAL TIME</span>
                                    <label>OFF<input type="checkbox" id="realtime" checked><span class="lever switch-col-cyan"></span>ON</label>
                                </div>
                            </div>
                        </div>
                        <ul class="header-dropdown m-r--5">
                            <li class="dropdown">
                                <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons">more_vert</i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li><a href="javascript:void(0);">Action</a></li>
                                    <li><a href="javascript:void(0);">Another action</a></li>
                                    <li><a href="javascript:void(0);">Something else here</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="body">
                        <div id="temptem" class="dashboard-flot-chart" data-url="{% url 'smartpower:sps_data' st %}"></div>
                    </div>
                </div>
            </div>
        </div>
        <!-- #END# CPU Usage -->
        <div class="row clearfix">
            <!-- Visitors -->
            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                <div class="card">
                    <div class="header">
                        <h2>CURRENT CHART</h2>
                        <ul class="header-dropdown m-r--5">
                            <li class="dropdown">
                                <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons">more_vert</i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li><a href="javascript:void(0);">Action</a></li>
                                    <li><a href="javascript:void(0);">Another action</a></li>
                                    <li><a href="javascript:void(0);">Something else here</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="body">
                        <canvas id="currentChartt" height="300" data-url="{% url 'smartpower:sps_data' st %}"></canvas>
                    </div>
                </div>
            </div>
            <!-- #END# Visitors -->
            <!-- Latest Social Trends -->
            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                <div class="card">
                    <div class="header">
                        <h2>POWER CHART</h2>
                        <ul class="header-dropdown m-r--5">
                            <li class="dropdown">
                                <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons">more_vert</i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li><a href="javascript:void(0);">Action</a></li>
                                    <li><a href="javascript:void(0);">Another action</a></li>
                                    <li><a href="javascript:void(0);">Something else here</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="body">
                        <!--<canvas id="voltageChart" height="200" data-url="{% url 'smartpower:voltageChart' %}"></canvas>-->
                        <canvas id="powerChartt" height="300" data-url="{% url 'smartpower:sps_data' st %}"></canvas>
                    </div>
                </div>
            </div>
            <!-- #END# Latest Social Trends -->
            <!-- Answered Tickets -->
            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                <div class="card">
                    <div class="header">
                        <h2>VOLTAGE CHART</h2>
                        <ul class="header-dropdown m-r--5">
                            <li class="dropdown">
                                <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons">more_vert</i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li><a href="javascript:void(0);">Action</a></li>
                                    <li><a href="javascript:void(0);">Another action</a></li>
                                    <li><a href="javascript:void(0);">Something else here</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="body">
                        <!--<canvas id="voltageChart" height="200" data-url="{% url 'smartpower:voltageChart' %}"></canvas>-->
                        <canvas id="voltageChartt" height="300" data-url="{% url 'smartpower:sps_data' st %}"></canvas>
                    </div>
                </div>
            </div>
            <!-- #END# Answered Tickets -->
        </div>

        <div class="row clearfix">
            <!-- Task Info -->
            <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
                <div class="card">
                    <div class="header">
                        <h2>TASK INFOS</h2>
                        <ul class="header-dropdown m-r--5">
                            <li class="dropdown">
                                <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons">more_vert</i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li><a href="javascript:void(0);">Action</a></li>
                                    <li><a href="javascript:void(0);">Another action</a></li>
                                    <li><a href="javascript:void(0);">Something else here</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="body">
                        <div class="table-responsive">
                            <table class="table table-hover dashboard-task-infos">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Task</th>
                                        <th>Status</th>
                                        <th>Manager</th>
                                        <th>Progress</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>Task A</td>
                                        <td><span class="label bg-green">Doing</span></td>
                                        <td>John Doe</td>
                                        <td>
                                            <div class="progress">
                                                <div class="progress-bar bg-green" role="progressbar" aria-valuenow="62" aria-valuemin="0" aria-valuemax="100" style="width: 62%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>Task B</td>
                                        <td><span class="label bg-blue">To Do</span></td>
                                        <td>John Doe</td>
                                        <td>
                                            <div class="progress">
                                                <div class="progress-bar bg-blue" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>Task C</td>
                                        <td><span class="label bg-light-blue">On Hold</span></td>
                                        <td>John Doe</td>
                                        <td>
                                            <div class="progress">
                                                <div class="progress-bar bg-light-blue" role="progressbar" aria-valuenow="72" aria-valuemin="0" aria-valuemax="100" style="width: 72%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>Task D</td>
                                        <td><span class="label bg-orange">Wait Approvel</span></td>
                                        <td>John Doe</td>
                                        <td>
                                            <div class="progress">
                                                <div class="progress-bar bg-orange" role="progressbar" aria-valuenow="95" aria-valuemin="0" aria-valuemax="100" style="width: 95%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>Task E</td>
                                        <td>
                                            <span class="label bg-red">Suspended</span>
                                        </td>
                                        <td>John Doe</td>
                                        <td>
                                            <div class="progress">
                                                <div class="progress-bar bg-red" role="progressbar" aria-valuenow="87" aria-valuemin="0" aria-valuemax="100" style="width: 87%"></div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- #END# Task Info -->
            <!-- Browser Usage -->
            <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
                <div class="card">
                    <div class="header">
                        <h2>BROWSER USAGE</h2>
                        <ul class="header-dropdown m-r--5">
                            <li class="dropdown">
                                <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons">more_vert</i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li><a href="javascript:void(0);">Action</a></li>
                                    <li><a href="javascript:void(0);">Another action</a></li>
                                    <li><a href="javascript:void(0);">Something else here</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div class="body">
                        <div id="donut_chart" class="dashboard-donut-chart"></div>
                    </div>
                </div>
            </div>
            <!-- #END# Browser Usage -->
        </div>
    </div>
</section>


{%comment%}
<script>
    $(document).ready(function(){
    setInterval(function () {

        var $currentChart = $("#currentChart");
        $.ajax({
        url: $currentChart.data("url"),
        success: function (data) {

            var ctx = $currentChart[0].getContext("2d");
            new Chart(ctx, {
            type: 'line',
            data: {
                labels: data.labels,
                datasets: [{
                label: 'current Red Phase',
                borderColor: 'rgba(247, 33, 97, 0.8)',
                backgroundColor: 'rgba(247, 33, 97, 0.5)',
                pointBorderColor: 'rgba(247, 33, 97, 0)',
                pointBackgroundColor: 'rgba(247, 33, 97, 0.8)',
                pointBorderWidth: 1,
                data: data.data_r
                },{
                    label: 'current yellow Phase',
                    borderColor: 'rgbargba(247, 232, 33, 0.75)',
                    backgroundColor: 'rgba(247, 232, 33, 0.3)',
                    pointBorderColor: 'rgba(247, 232, 33, 0)',
                    pointBackgroundColor: 'rgba(247, 232, 33, 0.9)',
                    pointBorderWidth: 1,
                    data: data.data_y
                },{
                    label: 'current Blue Phase',
                    borderColor: 'rgba(33, 83, 247, 0.75)',
                    backgroundColor: 'rgba(33, 83, 247, 0.3)',
                    pointBorderColor: 'rgba(33, 83, 247, 0)',
                    pointBackgroundColor: 'rgba(33, 83, 247, 0.9)',
                    pointBorderWidth: 1,
                    data: data.data_b
                }
                ]          
            },
            options: {
                responsive: true,
                legend: {
                position: 'top',
                },
                title: {
                display: true,
                text: 'current Chart'
                }
            }
            });					  
    
        }
        });

    }, 11250);
    });
</script>

   
	
<!--<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>-->
<script src="{% static 'js/iotPowerSystem/chart.js' %}"></script>


<script>
        var data = [], totalPoints = 110;
        var updateInterval = 320;
        var realtime = 'on';

        $(function () {
            //Real time ==========================================================================================
            var plot = $.plot('#real_time_chart', [getRandomData()], {
                series: {
                    shadowSize: 0,
                    color: 'rgb(0, 188, 212)'
                },
                grid: {
                    borderColor: '#f3f3f3',
                    borderWidth: 1,
                    tickColor: '#f3f3f3'
                },
                lines: {
                    fill: true
                },
                yaxis: {
                    min: 0,
                    max: 100
                },
                xaxis: {
                    min: 0,
                    max: 100
                }
            });

            function updateRealTime() {
                plot.setData([getRandomData()]);
                plot.draw();

                var timeout;
                if (realtime === 'on') {
                    timeout = setTimeout(updateRealTime, updateInterval);
                } else {
                    clearTimeout(timeout);
                }
            }

            updateRealTime();

            $('#realtime').on('change', function () {
                realtime = this.checked ? 'on' : 'off';
                updateRealTime();
            });
        });
        
</script>
<script>
    const ctx = document.getElementById('mc');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
        datasets: [{
          label: '# of Votes',
          data: [12, 19, 3, 5, 2, 3],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });
</script>
 {%endcomment%}
<script>
       
    fetch("{% url 'smartpower:tempChart'%}")
    .then(response => response.json())
    .then(data => {
       // document.getElementById("temptemp").innerHTML = pr; 
       let pr = JSON.parse(response["data"]);
       
        console.log(pr) 
    })    
   
</script>

{% endblock %}